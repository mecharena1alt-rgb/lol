-- services
local core_gui = game:GetService("CoreGui")
local players = game:GetService("Players")
local user_input_service = game:GetService("UserInputService")
local run_service = game:GetService("RunService")

-- config
local god_val = 99999
local normal_val = 10
local loop_delay = 0.1 -- faster than 1s to prevent death between ticks
local last_update = 0

-- ui construction
local screen_gui = Instance.new("ScreenGui")
screen_gui.Name = "ShieldGod"
screen_gui.Parent = core_gui

local main_frame = Instance.new("Frame")
main_frame.Name = "MainFrame"
main_frame.Size = UDim2.new(0, 160, 0, 50)
main_frame.Position = UDim2.new(0.1, 0, 0.1, 0)
main_frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
main_frame.BorderSizePixel = 0
main_frame.Active = true
main_frame.Draggable = true
main_frame.Parent = screen_gui

local ui_corner = Instance.new("UICorner")
ui_corner.CornerRadius = UDim.new(0, 8)
ui_corner.Parent = main_frame

local toggle_btn = Instance.new("TextButton")
toggle_btn.Name = "ToggleBtn"
toggle_btn.Size = UDim2.new(1, -10, 1, -10)
toggle_btn.Position = UDim2.new(0, 5, 0, 5)
toggle_btn.BackgroundColor3 = Color3.fromRGB(200, 50, 50) -- red (off)
toggle_btn.Text = "shield: normal"
toggle_btn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggle_btn.Font = Enum.Font.GothamBold
toggle_btn.TextSize = 14
toggle_btn.Parent = main_frame

local btn_corner = Instance.new("UICorner")
btn_corner.CornerRadius = UDim.new(0, 6)
btn_corner.Parent = toggle_btn

-- state
local is_enabled = false
local connection = nil

-- logic function
local function update_shield(val)
    local lp = players.LocalPlayer
    if not lp then return end
    
    -- path: players.localplayer.health.shieldHealth
    local health_folder = lp:FindFirstChild("health")
    if health_folder then
        local shield_val = health_folder:FindFirstChild("shieldHealth")
        if shield_val then
            shield_val.Value = val
        end
    end
end

-- toggle logic
toggle_btn.MouseButton1Click:Connect(function()
    is_enabled = not is_enabled
    
    if is_enabled then
        toggle_btn.Text = "shield: god"
        toggle_btn.BackgroundColor3 = Color3.fromRGB(50, 200, 50) -- green
        
        -- initial set
        update_shield(god_val)
        
        -- start loop to fight back against game resetting it
        connection = run_service.Heartbeat:Connect(function(dt)
            last_update = last_update + dt
            if last_update >= loop_delay then
                update_shield(god_val)
                last_update = 0
            end
        end)
    else
        toggle_btn.Text = "shield: normal"
        toggle_btn.BackgroundColor3 = Color3.fromRGB(200, 50, 50) -- red
        
        -- kill loop
        if connection then
            connection:Disconnect()
            connection = nil
        end
        
        -- reset to normal value
        update_shield(normal_val)
    end
end)

-- cleanup
user_input_service.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.RightControl then
        if connection then connection:Disconnect() end
        screen_gui:Destroy()
    end
end)
